#!/bin/bash
# Describe a Fastly CDN service with full configuration details
# Usage: fastly-describe --service-id SERVICE_ID [--profile PROFILE]

set -euo pipefail

# Default values
PROFILE="${FASTLY_PROFILE:-user}"
SERVICE_ID=""

# Parse arguments
while [[ $# -gt 0 ]]; do
    case "$1" in
        --service-id)
            SERVICE_ID="$2"
            shift 2
            ;;
        --profile)
            PROFILE="$2"
            shift 2
            ;;
        --help)
            echo "Usage: fastly-describe --service-id SERVICE_ID [--profile PROFILE]"
            echo ""
            echo "Describe a Fastly CDN service with full configuration details"
            echo ""
            echo "Options:"
            echo "  --service-id ID      Fastly service ID (required)"
            echo "  --profile PROFILE    Fastly profile to use (default: user)"
            echo ""
            echo "Examples:"
            echo "  fastly-describe --service-id abc123xyz"
            echo "  fastly-describe --service-id abc123xyz --profile user"
            exit 0
            ;;
        *)
            echo "Unknown option: $1" >&2
            echo "Use --help for usage information" >&2
            exit 1
            ;;
    esac
done

# Validate required arguments
if [[ -z "$SERVICE_ID" ]]; then
    echo "Error: --service-id is required" >&2
    echo "Use --help for usage information" >&2
    exit 1
fi

# Execute Fastly CLI
fastly service describe --service-id="$SERVICE_ID" --profile="$PROFILE" --json
